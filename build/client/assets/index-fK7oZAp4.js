import{a as t,o as s,w as Ae}from"./chunk-QMGIS6GS-u2wsVBQ8.js";import{A as Re}from"./AuthFooter-CKhZqaSr.js";import{C as De,a as Ne,d as Fe,b as Oe}from"./card-B9a7pVUc.js";import{u as We,a as Be,E as Ie,v as _e}from"./zod-CESMKTJV.js";import{c as Q}from"./utils-CBfrqCZ4.js";import{u as He}from"./AuthContext-DymqdCtb.js";import"./button-p6101m2e.js";import"./createLucideIcon-BaT0F7pg.js";import"./auth-DssmCHyn.js";var Le=Object.defineProperty,Ve=Object.defineProperties,Ge=Object.getOwnPropertyDescriptors,U=Object.getOwnPropertySymbols,ge=Object.prototype.hasOwnProperty,he=Object.prototype.propertyIsEnumerable,ve=(n,r,o)=>r in n?Le(n,r,{enumerable:!0,configurable:!0,writable:!0,value:o}):n[r]=o,$e=(n,r)=>{for(var o in r||(r={}))ge.call(r,o)&&ve(n,o,r[o]);if(U)for(var o of U(r))he.call(r,o)&&ve(n,o,r[o]);return n},ze=(n,r)=>Ve(n,Ge(r)),qe=(n,r)=>{var o={};for(var l in n)ge.call(n,l)&&r.indexOf(l)<0&&(o[l]=n[l]);if(n!=null&&U)for(var l of U(n))r.indexOf(l)<0&&he.call(n,l)&&(o[l]=n[l]);return o};function Je(n){let r=setTimeout(n,0),o=setTimeout(n,10),l=setTimeout(n,50);return[r,o,l]}function Ze(n){let r=t.useRef();return t.useEffect(()=>{r.current=n}),r.current}var Ke=18,xe=40,Qe=`${xe}px`,Ue=["[data-lastpass-icon-root]","com-1password-button","[data-dashlanecreated]",'[style$="2147483647 !important;"]'].join(",");function Xe({containerRef:n,inputRef:r,pushPasswordManagerStrategy:o,isFocused:l}){let[g,c]=t.useState(!1),[C,y]=t.useState(!1),[M,D]=t.useState(!1),j=t.useMemo(()=>o==="none"?!1:(o==="increase-width"||o==="experimental-no-flickering")&&g&&C,[g,C,o]),f=t.useCallback(()=>{let h=n.current,T=r.current;if(!h||!T||M||o==="none")return;let w=h,P=w.getBoundingClientRect().left+w.offsetWidth,I=w.getBoundingClientRect().top+w.offsetHeight/2,u=P-Ke,V=I;document.querySelectorAll(Ue).length===0&&document.elementFromPoint(u,V)===h||(c(!0),D(!0))},[n,r,M,o]);return t.useEffect(()=>{let h=n.current;if(!h||o==="none")return;function T(){let P=window.innerWidth-h.getBoundingClientRect().right;y(P>=xe)}T();let w=setInterval(T,1e3);return()=>{clearInterval(w)}},[n,o]),t.useEffect(()=>{let h=l||document.activeElement===r.current;if(o==="none"||!h)return;let T=setTimeout(f,0),w=setTimeout(f,2e3),P=setTimeout(f,5e3),I=setTimeout(()=>{D(!0)},6e3);return()=>{clearTimeout(T),clearTimeout(w),clearTimeout(P),clearTimeout(I)}},[r,l,o,f]),{hasPWMBadge:g,willPushPWMBadge:j,PWM_BADGE_SPACE_WIDTH:Qe}}var be=t.createContext({}),we=t.forwardRef((n,r)=>{var o=n,{value:l,onChange:g,maxLength:c,textAlign:C="left",pattern:y,placeholder:M,inputMode:D="numeric",onComplete:j,pushPasswordManagerStrategy:f="increase-width",pasteTransformer:h,containerClassName:T,noScriptCSSFallback:w=Ye,render:P,children:I}=o,u=qe(o,["value","onChange","maxLength","textAlign","pattern","placeholder","inputMode","onComplete","pushPasswordManagerStrategy","pasteTransformer","containerClassName","noScriptCSSFallback","render","children"]),V,re,ae,oe,le;let[Ee,ye]=t.useState(typeof u.defaultValue=="string"?u.defaultValue:""),d=l??Ee,N=Ze(d),G=t.useCallback(e=>{g?.(e),ye(e)},[g]),S=t.useMemo(()=>y?typeof y=="string"?new RegExp(y):y:null,[y]),p=t.useRef(null),X=t.useRef(null),Y=t.useRef({value:d,onChange:G,isIOS:typeof window<"u"&&((re=(V=window?.CSS)==null?void 0:V.supports)==null?void 0:re.call(V,"-webkit-touch-callout","none"))}),Z=t.useRef({prev:[(ae=p.current)==null?void 0:ae.selectionStart,(oe=p.current)==null?void 0:oe.selectionEnd,(le=p.current)==null?void 0:le.selectionDirection]});t.useImperativeHandle(r,()=>p.current,[]),t.useEffect(()=>{let e=p.current,a=X.current;if(!e||!a)return;Y.current.value!==e.value&&Y.current.onChange(e.value),Z.current.prev=[e.selectionStart,e.selectionEnd,e.selectionDirection];function m(){if(document.activeElement!==e){z(null),q(null);return}let i=e.selectionStart,v=e.selectionEnd,K=e.selectionDirection,E=e.maxLength,O=e.value,k=Z.current.prev,A=-1,R=-1,W;if(O.length!==0&&i!==null&&v!==null){let ke=i===v,Me=i===O.length&&O.length<E;if(ke&&!Me){let B=i;if(B===0)A=0,R=1,W="forward";else if(B===E)A=B-1,R=B,W="backward";else if(E>1&&O.length>1){let ne=0;if(k[0]!==null&&k[1]!==null){W=B<k[1]?"backward":"forward";let Te=k[0]===k[1]&&k[0]<E;W==="backward"&&!Te&&(ne=-1)}A=ne+B,R=ne+B+1}}A!==-1&&R!==-1&&A!==R&&p.current.setSelectionRange(A,R,W)}let me=A!==-1?A:i,fe=R!==-1?R:v,Pe=W??K;z(me),q(fe),Z.current.prev=[me,fe,Pe]}if(document.addEventListener("selectionchange",m,{capture:!0}),m(),document.activeElement===e&&ee(!0),!document.getElementById("input-otp-style")){let i=document.createElement("style");if(i.id="input-otp-style",document.head.appendChild(i),i.sheet){let v="background: transparent !important; color: transparent !important; border-color: transparent !important; opacity: 0 !important; box-shadow: none !important; -webkit-box-shadow: none !important; -webkit-text-fill-color: transparent !important;";J(i.sheet,"[data-input-otp]::selection { background: transparent !important; color: transparent !important; }"),J(i.sheet,`[data-input-otp]:autofill { ${v} }`),J(i.sheet,`[data-input-otp]:-webkit-autofill { ${v} }`),J(i.sheet,"@supports (-webkit-touch-callout: none) { [data-input-otp] { letter-spacing: -.6em !important; font-weight: 100 !important; font-stretch: ultra-condensed; font-optical-sizing: none !important; left: -1px !important; right: 1px !important; } }"),J(i.sheet,"[data-input-otp] + * { pointer-events: all !important; }")}}let x=()=>{a&&a.style.setProperty("--root-height",`${e.clientHeight}px`)};x();let b=new ResizeObserver(x);return b.observe(e),()=>{document.removeEventListener("selectionchange",m,{capture:!0}),b.disconnect()}},[]);let[ie,se]=t.useState(!1),[$,ee]=t.useState(!1),[F,z]=t.useState(null),[_,q]=t.useState(null);t.useEffect(()=>{Je(()=>{var e,a,m,x;(e=p.current)==null||e.dispatchEvent(new Event("input"));let b=(a=p.current)==null?void 0:a.selectionStart,i=(m=p.current)==null?void 0:m.selectionEnd,v=(x=p.current)==null?void 0:x.selectionDirection;b!==null&&i!==null&&(z(b),q(i),Z.current.prev=[b,i,v])})},[d,$]),t.useEffect(()=>{N!==void 0&&d!==N&&N.length<c&&d.length===c&&j?.(d)},[c,j,N,d]);let H=Xe({containerRef:X,inputRef:p,pushPasswordManagerStrategy:f,isFocused:$}),ue=t.useCallback(e=>{let a=e.currentTarget.value.slice(0,c);if(a.length>0&&S&&!S.test(a)){e.preventDefault();return}typeof N=="string"&&a.length<N.length&&document.dispatchEvent(new Event("selectionchange")),G(a)},[c,G,N,S]),ce=t.useCallback(()=>{var e;if(p.current){let a=Math.min(p.current.value.length,c-1),m=p.current.value.length;(e=p.current)==null||e.setSelectionRange(a,m),z(a),q(m)}ee(!0)},[c]),de=t.useCallback(e=>{var a,m;let x=p.current;if(!h&&(!Y.current.isIOS||!e.clipboardData||!x))return;let b=e.clipboardData.getData("text/plain"),i=h?h(b):b;e.preventDefault();let v=(a=p.current)==null?void 0:a.selectionStart,K=(m=p.current)==null?void 0:m.selectionEnd,E=(v!==K?d.slice(0,v)+i+d.slice(K):d.slice(0,v)+i+d.slice(v)).slice(0,c);if(E.length>0&&S&&!S.test(E))return;x.value=E,G(E);let O=Math.min(E.length,c-1),k=E.length;x.setSelectionRange(O,k),z(O),q(k)},[c,G,S,d]),Se=t.useMemo(()=>({position:"relative",cursor:u.disabled?"default":"text",userSelect:"none",WebkitUserSelect:"none",pointerEvents:"none"}),[u.disabled]),pe=t.useMemo(()=>({position:"absolute",inset:0,width:H.willPushPWMBadge?`calc(100% + ${H.PWM_BADGE_SPACE_WIDTH})`:"100%",clipPath:H.willPushPWMBadge?`inset(0 ${H.PWM_BADGE_SPACE_WIDTH} 0 0)`:void 0,height:"100%",display:"flex",textAlign:C,opacity:"1",color:"transparent",pointerEvents:"all",background:"transparent",caretColor:"transparent",border:"0 solid transparent",outline:"0 solid transparent",boxShadow:"none",lineHeight:"1",letterSpacing:"-.5em",fontSize:"var(--root-height)",fontFamily:"monospace",fontVariantNumeric:"tabular-nums"}),[H.PWM_BADGE_SPACE_WIDTH,H.willPushPWMBadge,C]),Ce=t.useMemo(()=>t.createElement("input",ze($e({autoComplete:u.autoComplete||"one-time-code"},u),{"data-input-otp":!0,"data-input-otp-placeholder-shown":d.length===0||void 0,"data-input-otp-mss":F,"data-input-otp-mse":_,inputMode:D,pattern:S?.source,"aria-placeholder":M,style:pe,maxLength:c,value:d,ref:p,onPaste:e=>{var a;de(e),(a=u.onPaste)==null||a.call(u,e)},onChange:ue,onMouseOver:e=>{var a;se(!0),(a=u.onMouseOver)==null||a.call(u,e)},onMouseLeave:e=>{var a;se(!1),(a=u.onMouseLeave)==null||a.call(u,e)},onFocus:e=>{var a;ce(),(a=u.onFocus)==null||a.call(u,e)},onBlur:e=>{var a;ee(!1),(a=u.onBlur)==null||a.call(u,e)}})),[ue,ce,de,D,pe,c,_,F,u,S?.source,d]),te=t.useMemo(()=>({slots:Array.from({length:c}).map((e,a)=>{var m;let x=$&&F!==null&&_!==null&&(F===_&&a===F||a>=F&&a<_),b=d[a]!==void 0?d[a]:null,i=d[0]!==void 0?null:(m=M?.[a])!=null?m:null;return{char:b,placeholderChar:i,isActive:x,hasFakeCaret:x&&b===null}}),isFocused:$,isHovering:!u.disabled&&ie}),[$,ie,c,_,F,u.disabled,d]),je=t.useMemo(()=>P?P(te):t.createElement(be.Provider,{value:te},I),[I,te,P]);return t.createElement(t.Fragment,null,w!==null&&t.createElement("noscript",null,t.createElement("style",null,w)),t.createElement("div",{ref:X,"data-input-otp-container":!0,style:Se,className:T},je,t.createElement("div",{style:{position:"absolute",inset:0,pointerEvents:"none"}},Ce)))});we.displayName="Input";function J(n,r){try{n.insertRule(r)}catch{console.error("input-otp could not insert CSS rule:",r)}}var Ye=`
[data-input-otp] {
  --nojs-bg: white !important;
  --nojs-fg: black !important;

  background-color: var(--nojs-bg) !important;
  color: var(--nojs-fg) !important;
  caret-color: var(--nojs-fg) !important;
  letter-spacing: .25em !important;
  text-align: center !important;
  border: 1px solid var(--nojs-fg) !important;
  border-radius: 4px !important;
  width: 100% !important;
}
@media (prefers-color-scheme: dark) {
  [data-input-otp] {
    --nojs-bg: black !important;
    --nojs-fg: white !important;
  }
}`;function et({className:n,containerClassName:r,...o}){return s.jsx(we,{"data-slot":"input-otp",containerClassName:Q("flex items-center gap-2 has-disabled:opacity-50",r),className:Q("disabled:cursor-not-allowed",n),...o})}function tt({className:n,...r}){return s.jsx("div",{"data-slot":"input-otp-group",className:Q("flex items-center",n),...r})}function L({index:n,className:r,...o}){const l=t.useContext(be),{char:g,hasFakeCaret:c,isActive:C}=l?.slots[n]??{};return s.jsxs("div",{"data-slot":"input-otp-slot","data-active":C,className:Q("data-[active=true]:border-ring data-[active=true]:ring-ring/50 data-[active=true]:aria-invalid:ring-destructive/20 dark:data-[active=true]:aria-invalid:ring-destructive/40 aria-invalid:border-destructive data-[active=true]:aria-invalid:border-destructive dark:bg-input/30 border-input relative flex h-9 w-9 items-center justify-center border-y border-r text-sm shadow-xs transition-all outline-none first:rounded-l-md first:border-l last:rounded-r-md data-[active=true]:z-10 data-[active=true]:ring-[3px]",r),...o,children:[g,c&&s.jsx("div",{className:"pointer-events-none absolute inset-0 flex items-center justify-center",children:s.jsx("div",{className:"animate-caret-blink bg-foreground h-4 w-px duration-1000"})})]})}const dt=()=>[{title:"Verificar 2FA - NaMesaJá"}],pt=Ae(function(){const{verify2FA:r}=He(),{handleSubmit:o,formState:{errors:l,isSubmitting:g},setValue:c,watch:C,setError:y}=We({resolver:Be(_e),defaultValues:{otp:""}}),M=C("otp"),D=async j=>{try{const f=await r({twoFactorCode:j.otp});if(!f.status)return y("root",{type:"manual",message:f.message})}catch(f){console.error("2FA verification error:",f),y("root",{type:"manual",message:f instanceof Error?f.message:"Erro ao verificar código."})}};return s.jsxs(De,{className:"flex flex-col items-center gap-4",children:[s.jsx(Ne,{className:"text-center text-4xl",children:"Código de verificação"}),s.jsx(Fe,{className:"text-center text-sm text-gray-500",children:"Digite o código de verificação enviado para o seu email"}),s.jsx(Oe,{className:"flex flex-col gap-6",children:s.jsxs("form",{onSubmit:o(D),className:"flex flex-col gap-6",children:[s.jsxs("div",{className:"flex flex-col gap-2",children:[s.jsx("div",{className:"flex justify-center",children:s.jsx(et,{value:M,onChange:j=>c("otp",j),maxLength:6,children:s.jsxs(tt,{children:[s.jsx(L,{index:0}),s.jsx(L,{index:1}),s.jsx(L,{index:2}),s.jsx(L,{index:3}),s.jsx(L,{index:4}),s.jsx(L,{index:5})]})})}),l.otp&&s.jsx("span",{className:"text-center text-sm text-red-600",children:l.otp.message})]}),s.jsx(Ie,{error:l.root?.message}),s.jsx(Re,{question:"Não recebeu o código?",linkText:"Enviar novamente",linkTo:"/auth/verify-2fa",buttonText:g?"Verificando...":"Verificar código",disabled:g})]})})]})});export{pt as default,dt as meta};
